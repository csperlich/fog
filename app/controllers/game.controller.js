var config = require('../../config/config'),
    MongoClient = require('mongodb').MongoClient,
    ObjectId = require('mongodb').ObjectID;

exports.play = function(req, res) {
  var game = req.game;
  console.log('play', game);
  res.render('games/pages/game', {
    title: game.title,
    scripts: game.config.scripts || [],
    styles: game.config.styles || [],
    startingPoint: game.config.startingPoint,
    gamePath: req.game.gamePath
  });
};

exports.getById = function(req, res, next, id) {
  MongoClient.connect(config.db, function(err, db) {
    try {
      db.collection('games').findOne({_id: ObjectId(id)},
        function (err, game) {
          req.game = game;
          db.close();
          next();
      });
    } catch (e) {
      console.log('Game not found: ' + id);
      next();
    }
  });
};
